library(jsonlite)
library(readr)
library(tidytext)
library(tidyr)
library(tidyverse)
library(tidymodels)
library(textrecipes)
trainSet <- read_file("train.json") |>
fromJSON()
testSet <- read_file("test.json") |>
fromJSON()
## Define TF-IDF9
rec <- recipe(cuisine ~ ingredients, data = trainSet) |>
step_mutate(ingredients = tokenlist(ingredients)) |>
step_tokenfilter(ingredients, max_tokens=500) |>
step_tfidf(ingredients)
rf_spec <- rand_forest(
mtry = 10,        # number of variables randomly sampled at each split
trees = 500,      # number of trees
min_n = 5         # minimum samples per leaf
) |>
set_engine("ranger") |>
set_mode("classification")
rf_workflow <- workflow() |>
add_model(rf_spec) |>
add_recipe(rec)
rf_fit <- rf_workflow |> fit(data = trainSet)
test_predictions <- predict(rf_fit, testSet) %>%
bind_cols(testSet)
submission <- test_predictions %>%
select(id, cuisine = .pred_class)
write_csv(submission, "submission.csv")
